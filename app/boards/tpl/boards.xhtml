<tal:block metal:define-macro="postbox">
    <div style="text-align:center;font-size:4em;">${boardinfo/title}</div>
    <hr />
    <div class="postarea">
        <form id="postform" enctype="multipart/form-data" action="${imgbb/base_url}/index.php?app=boards&amp;mod=boardpage&amp;area=view&amp;do=process" method="post">
            <input type="hidden" name="action" value="${imgbb/highlight/action}" />
            <input type="hidden" name="subaction" value="${imgbb/highlight/subaction}" />
            <input type="hidden" name="MAX_FILE_SIZE" value="8388608" />
            <table>
                <tbody>
                <tr tal:condition="not: imgbb/user/registered">
                    <td class="tdlabel">
                        Name
                    </td>
                    <td class="tdinput">
                        <input id="postername" type="text" name="postername" />
                        <a onclick="displayhelp()" href="#">
                            <span class="helpme">
                                ?
                            </span>
                        </a>
                    </td>
                </tr>

                <tr tal:condition="imgbb/user/registered">
                    <td class="tdlabel">
                        Name
                    </td>
                    <td class="tdinput">
                        <select name="name">
                            <option value="main">
                                ${imgbb/user/display_name}!${imgbb/user/display_trip}
                            </option>
                            <option value="${name/id}" tal:repeat="name imgbb/user/names">
                                ${name/display_name}!${name/display_trip}
                            </option>
                        </select>
                        <input id="goanon" type="button" name="goanon" value="Go Anon!" />
                        <a onclick="displayhelp()" href="#">
                            <span class="helpme">
                                ?
                            </span>
                        </a>
                    </td>
                </tr>

                <tr>
                    <td class="tdlabel">
                        Email
                    </td>
                    <td class="tdinput">
                        <input id="email" type="text" name="email"/>
                        <a onclick="displayhelp()" href="#">
                            <span class="helpme">
                                ?
                            </span>
                        </a>
                    </td>
                </tr>

                <tr>
                    <td class="tdlabel">
                        Subject
                    </td>
                    <td class="tdinput">
                        <input id="subject" type="text" name="subject"/>
                        <input id="submit" type="submit" onclick="" value="New Post" name="Submit" />
                        <a onclick="displayhelp()" href="#">
                            <span class="helpme">
                                ?
                            </span>
                        </a>
                    </td>
                </tr>

                <tr>
                    <td class="tdlabel">
                        Message
                    </td>
                    <td class="tdinput">
                        <textarea id="message" name="body" />
                        <a onclick="displayhelp()" href="#">
                            <span class="helpme">
                                ?
                            </span>
                        </a>
                    </td>
                </tr>

                <tr>
                    <td class="tdlabel">
                        File
                    </td>
                    <td class="tdinput">
                        <input id="file" type="file" name="file"/>
                        <a onclick="displayhelp()" href="#">
                            <span class="helpme">
                                ?
                            </span>
                        </a>
                    </td>
                </tr>

                <tr>
                    <td class="tdlabel">
                        Embed
                    </td>
                    <td class="tdinput">
                        <input id="embed" type="text" name="embed"/>
                        <a onclick="displayhelp()" href="#">
                            <span class="helpme">
                                ?
                            </span>
                        </a>
                    </td>
                </tr>

                <tr tal:condition="not: true: imgbb/user/registered">
                    <td class="tdlabel">
                        Password
                    </td>
                    <td class="tdinput">
                        <input id="password" type="password" name="password"/>
                        <a onclick="displayhelp()" href="#">
                            <span class="helpme">
                                ?
                            </span>
                        </a>
                    </td>
                </tr>
                <tr tal:condition="imgbb/user/registered">
                    <td class="tdlabel">
                        Options
                    </td>
                    <td class="tdinput">
                        <label for="sage">Sage: </label>
                        <input id="sage" type="checkbox" name="sage"/>
                        <a onclick="displayhelp()" href="#">
                            <span class="helpme">
                                ?
                            </span>
                        </a>
                    </td>
                </tr>
                <tr tal:condition="imgbb/user/registered">
                    <td class="tdlabel">
                        Moderator
                    </td>
                    <td class="tdinput">
                        <label for="displaystatus">Display Staff Status: </label>
                        <input id="displaystatus" type="checkbox" name="displaystatus"/>
                        <!--<a onclick="displayhelp()" href="#">-->
                            <!--<span class="helpme">-->
                                <!--?-->
                            <!--</span>-->
                        <!--</a>-->
                    </td>
                    <td class="tdinput">
                        <label for="lockthread">Lock Thread: </label>
                        <input id="lockthread" type="checkbox" name="lock"/>
                        <!--<a onclick="displayhelp()" href="#">-->
                            <!--<span class="helpme">-->
                                <!--?-->
                            <!--</span>-->
                        <!--</a>-->
                    </td>
                    <td class="tdinput">
                        <label for="rawhtml">Raw HTML: </label>
                        <input id="rawhtml" type="checkbox" name="rawhtml"/>
                        <!--<a onclick="displayhelp()" href="#">-->
                        <!--<span class="helpme">-->
                        <!--?-->
                        <!--</span>-->
                        <!--</a>-->
                    </td>
                    <td class="tdinput">
                        <label for="sticky">Sticky: </label>
                        <input id="sticky" type="checkbox" name="sticky"/>
                        <!--<a onclick="displayhelp()" href="#">-->
                        <!--<span class="helpme">-->
                        <!--?-->
                        <!--</span>-->
                        <!--</a>-->
                    </td>
                </tr>

                </tbody>
            </table>
        </form>
    </div>
    <hr />
</tal:block>

<!--<tal:block metal:define-macro="boards_debug">-->
<!--dumping array imgbb info<br /><hr />-->
<!--<tal:block tal:repeat="var imgbb">-->
    <!--<tal:block tal:condition="php: is_array(var)">-->
        <!--<div style="border:2px solid; max-width:600px;">-->
            <!--<b>imgbb['${repeat/var/key}']</b><br />-->
            <!--<tal:block tal:repeat="v var">-->
                <!--${repeat/v/key} => ${v}<br />-->
            <!--</tal:block>-->
        <!--</div>-->
<!---->
    <!--</tal:block>-->
    <!--<tal:block tal:condition="php: !is_array(var)">-->
        <!--${repeat/var/key}=> ${var}<br />-->
    <!--</tal:block>-->
<!--</tal:block>-->
<!--<hr />-->
<!--</tal:block>-->


<tal:block metal:define-macro="parent_mod_tools">
<span tal:condition="imgbb/user/registered" class="btns" >
    [<a href="index.php?app=boards&amp;mod=manage&amp;area=delete&amp;action=${parent/boardid}&amp;subaction=${parent/id}">D</a>
        &amp;
    <a href="index.php?app=main&amp;mod=manage&amp;area=ban&amp;action=${parent/boardid}&amp;subaction=${parent/id}">B</a>]

    [<a href="index.php?app=boards&amp;mod=manage&amp;area=move&amp;action=${parent/boardid}&amp;subaction=${parent/id}">Move</a>
    /
    <a href="index.php?app=boards&amp;mod=manage&amp;area=edit&amp;action=${parent/boardid}&amp;subaction=${parent/id}">Edit</a>
    /
    <a href="index.php?app=boards&amp;mod=manage&amp;area=bump&amp;action=${parent/boardid}&amp;subaction=${parent/id}">Bump</a>
    /
    <a href="index.php?app=boards&amp;mod=manage&amp;area=kill&amp;action=${parent/boardid}&amp;subaction=${parent/id}">Force Sage</a>]
</span>
</tal:block>

<tal:block metal:define-macro="reply_mod_tools">
<span tal:condition="imgbb/user/registered" class="btns" >
    [<a href="index.php?app=boards&amp;mod=manage&amp;area=delete&amp;action=${parent/boardid}&amp;subaction=${reply/id}">D</a>
        &amp;
    <a href="index.php?app=main&amp;mod=manage&amp;area=ban&amp;action=${parent/boardid}&amp;subaction=${reply/id}">B</a>
    /
    <a href="index.php?app=boards&amp;mod=manage&amp;area=edit&amp;action=${parent/boardid}&amp;subaction=${reply/id}">Edit</a>]
</span>
</tal:block>

<tal:block metal:define-macro="pagination">
<div class="pagination">
    <a href="${imgbb/base_url}/index.php?/q/previous_page_algorithm">Previous</a>
    |
    <a href="${imgbb/base_url}/index.php?/q/page_algorithm">1</a>
    |
    <span class="currentpage">2</span>
    |
    <a href="${imgbb/base_url}/index.php?/q/page_algorithm">3</a>
    |
    <a href="${imgbb/base_url}/index.php?/q/page_algorithm">4</a>
    |
    <a href="${imgbb/base_url}/index.php?/q/next_page_algorithm">Next</a>
</div>
</tal:block>

<tal:block metal:define-macro="board">
    <div class="board">
        <tal:block tal:repeat="parent parents">
            <div id="two_${parent/id}" class="thread">
                <div class="postcontainer">
                    <div id="one_${parent/id}" class="post op">
                        <div class="file btns" tal:condition="parent/file">
                            <div class="fileinfo">
                                <span class="filetext">
                                    File:
                                    <a href="${imgbb/base_url}/files/src/${parent/file}.${parent/file_type}" tal:content="structure php: parents.file_original()"/>
                                    ${structure string: &ndash;} (${parent/file_size}, ${parent/image_h}x${parent/image_w})
                                </span>
                            </div>
                            <a class="filethumb" target="_blank" href="${imgbb/base_url}/files/src/${parent/file}.${parent/file_type}">
                                <img src="${imgbb/base_url}/files/src/${parent/file}.${parent/file_type}" height="${parent/thumb_h}" width="${parent/thumb_w}" />
                            </a>
                        </div>
                        <div class="postinfo">
                            <label>
                                <input type="checkbox" />
                                <span class="subject" tal:content="structure parent/subject"/>
                                <span class="namespan">
                                    <span class="name" tal:content="parent/display_name" /><span class="postertrip" tal:condition="parent/display_tripcode">!${parent/display_tripcode}</span>
                                </span>
                                <span class="mod" tal:condition="parent/rank" tal:attributes="style parent/user_rank_display_stylization" tal:content="structure parent/user_rank_display_name" />
                                <span class="datetime" tal:content="parent/timestamp"/>
                                <span class="postnumber">
                                    <a href="${imgbb/base_url}/index.php?/${boardinfo/board_name}/${parent/id}-#${parent/id}">
                                        No.
                                    </a>
                                    <a href="${imgbb/base_url}/pls" tal:content="parent/id"/>
                                </span>
                                <span class="btns" tal:condition="not: true: inthread">
                                    <tal:block tal:condition="parent/stickied" tal:content="string:Sticky.png" />
                                    <tal:block tal:condition="parent/locked" tal:content="string:Locked.png" />
                                    [<a href="${imgbb/base_url}/index.php?/${boardinfo/board_name}/${parent/id}">View</a>]
                                </span>
                                <span tal:condition="imgbb/user/registered">
                                    <tal:block metal:use-macro="parent_mod_tools" />
                                </span>
                            </label>
                        </div>
                        <blockquote class="postmessage" tal:content="structure parent/message" />
                    </div>
                    <!--<tal:block tal:repeat="replycount repliescount/${parent/id}">-->
                        <!--<tal:block tal:repeat="reply replycount">-->
                            <span class="postcount">${parent/replycount} replies made in total.</span>
                        <!--</tal:block>-->
                    <!--</tal:block>-->
                </div>
                <!--<tal:block tal:repeat="parentreplies replies/${parent/id}">-->
                <tal:block tal:repeat="reply replies">
                    <div class="postcontainer" tal:condition="php: reply['parentid'] eq parent['id']">
                        <div id="${reply/id}" class="post reply">
                            <!--helloWorld${parent/id}-->
                            <!--${repeat/reply/key}-->
                            <div class="postinfo">
                                <label>
                                    <input type="checkbox" />
                                    <span class="subject" tal:content="structure reply/subject"/>
                                    <span class="namespan">
                                        <span class="name">
                                            ${reply/display_name}</span><span class="postertrip" tal:condition="reply/display_tripcode">!${reply/display_tripcode}
                                        </span>
                                    </span>
                                    <span class="mod" tal:condition="reply/rank" tal:attributes="style reply/user_rank_display_stylization" tal:content="structure reply/user_rank_display_name" />
                                    <span class="datetime" tal:content="reply/timestamp" />
                                    <span class="postnumber">
                                        <a href="${imgbb/base_url}/index.php?/${boardinfo/board_name}/${parent/id}-#${reply/id}">
                                            No.
                                        </a>
                                        <a href="${imgbb/base_url}/pls" tal:content="reply/id"/>
                                    </span>
                                    <span tal:condition="imgbb/user/registered">
                                        <tal:block metal:use-macro="reply_mod_tools" />
                                    </span>
                                </label>
                            </div>
                            <div class="file btns" tal:condition="reply/file">
                                <div class="fileinfo">
                                    <span class="filetext">
                                        File:
                                        <a href="${imgbb/base_url}/files/src/${reply/file}.${reply/file_type}" tal:content="structure php: replies.file_original()" />
                                        ${structure string: &ndash;} (${reply/file_size}, ${reply/image_h}x${reply/image_w})
                                    </span>
                                </div>
                                <a class="filethumb" target="_blank" href="${imgbb/base_url}/files/src/${reply/file}.${reply/file_type}">
                                    <img src="${imgbb/base_url}/files/src/${reply/file}.${reply/file_type}" height="${reply/thumb_h}" width="${reply/thumb_w}" />
                                </a>
                            </div>
                            <blockquote class="postmessage" tal:content="structure reply/message"/>
                        </div>
                    </div>
                </tal:block>
            </div>
            <hr />
        </tal:block>
        <!--Pagination area-->
        <tal:block metal:use-macro="pagination" />
        <!--Manipulation area-->
    </div>
</tal:block>